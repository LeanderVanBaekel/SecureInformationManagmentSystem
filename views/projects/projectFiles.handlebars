{{> header}}

<div class="container" id="projectDetail">

	{{> side-nav}}

	<main>
		<nav class="project-nav">
			<a class="active" href="{{req.baseUrl}}/projects/{{data.project._id}}/files">Bestanden</a>
			<a href="{{req.baseUrl}}/projects/{{data.project._id}}/auth">Authenticatie gegevens</a>
		</nav>

		<div class="files-container">
			<div class="files-header">
				<a href="{{data.baseUrl}}">{{title}}</a>
				{{#each data.path}}
					> <a href="{{../data.baseUrl}}/{{id}}">{{name}}</a>
				{{/each}}
				<div class="new-file-button newFileButtonListner" id="newFileButton">
					+
				</div>
			</div>

			<div class="files-list">
				{{#each data.files}}
					{{#if (ifEqual type "folder")}}
						<div class="item-wrapper">
							<a href="{{../data.baseUrl}}/{{_id}}" class="files-item files-item-folder">
								<img src="http://pngimg.com/uploads/folder/folder_PNG8764.png" alt="">
								<p class="name">{{name}}</p>
								<div class="circle n-{{permissionId}}">
									<p>{{permissionId}}</p>
								</div>
								<p class="user">{{../req.session.userName}}</p>
								<div class="action-button">
									<p>&#11044; &#11044; &#11044;</p>
								</div>
							</a>
							<div class="action-menu">
								<ul>
									<li>Bekijk in browser</li>
									<li>Download</li>
									<li>Wijzigen</li>
									<li>Verwijderen</li>
								</ul>
							</div>
						</div>

					{{/if}}
				{{/each}}
				{{#each data.files}}
					{{#if (ifEqual type "file")}}
						<a href="/file/{{../data.project._id}}/{{_id}}/ads" class="files-item files-item-folder">
							<img src="http://icons.iconarchive.com/icons/dtafalonso/android-lollipop/512/Docs-icon.png" alt="">
							<p class="name">{{name}}</p>
							<div class="circle n-{{permissionId}}">
								<p>{{permissionId}}</p>
							</div>
							<p class="user">{{../req.session.userName}}</p>
							<div class="action-button">
								<p>&#11044; &#11044; &#11044;</p>
							</div>
						</a>
					{{/if}}
				{{/each}}

				{{!-- <div class="files-item files-item-folder files-item-active">
					<p>Vormgeving</p>
				</div>  --}}
			</div>

		</div>
<script type="text/javascript">
	var action = document.querySelectorAll('.action-button');
	for (var i = 0; i < action.length; i++) {
		action[i].addEventListener('click', function(e) {
			e.preventDefault();
			alert('hoi');
		});
	}
</script>

	</main>

	<div class="popup" id="newFilePopup">
		<div class="popup-closer newFileButtonListner">

		</div>
		<div class="popup-content">
			<h2>map toevoegen</h2>

			<form action="/file/create" enctype="multipart/form-data" method="post">

				{{#if error}}<p class="error-log">{{error}}</p>{{/if}}

				<input type="hidden" name="redirect" value="{{req.url}}">

				<label for="fileName">Naam</label>
				<input type="text" name="fileName" value=""><br>

				<label for="file">Bestand</label>
				<input type="file" name="file" multiple value=""><br>

				<label for="type">Type</label>
				<select name="type">
					<option value="folder">folder</option>
					<option value="file">file</option>
				</select><br>

				{{!-- <label for="projectId">projectId</label> --}}
				<input type="hidden" name="projectId" value="{{data.projectId}}">

				{{!-- <label for="containdIn">containdIn (in welke folder zit ik?)</label> --}}
				<input type="hidden" name="containdIn" value="{{data.container._id}}">

				<label for="premissionId">premissionId</label>
				<input type="number" min="1" max="6" name="permissionId" value="{{req.session.user.permissionId}}"><br>

				<button type="submit">Aanmaken</button>
			</form>

		</div>
	</div>

</div>

<script type="text/javascript">

var popup = function(listners, element) {
	var toggle = function() {
		document.getElementById(element).classList.toggle('show');
	}

	var listners = document.querySelectorAll('.' + listners);

	listners.forEach(function(listner) {
		listner.addEventListener('click', toggle);
	});

  // document.getElementById(button).addEventListener('click', active);
  // console.log('hoi');
}


	window.onload = function() {
		popup('newFileButtonListner', 'newFilePopup');
	};
</script>
